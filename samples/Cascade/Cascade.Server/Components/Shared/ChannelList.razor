@implements IAsyncDisposable

<div class="channel-list">
    <div class="channel-list-header">
        <h3>Channels</h3>
        <button class="btn btn-sm btn-outline-light" @onclick="ShowCreateModal">
            <span>+</span>
        </button>
    </div>

    @if (subscriber is null || !subscriber.IsLoaded)
    {
        <div class="loading">Loading channels...</div>
    }
    else if (subscriber.Current?.ChannelIds.Count == 0)
    {
        <div class="empty-state">
            <p>No channels yet.</p>
            <button class="btn btn-primary btn-sm" @onclick="ShowCreateModal">Create your first channel</button>
        </div>
    }
    else
    {
        <ul class="channel-items">
            @foreach (string channelId in subscriber.Current!.ChannelIds)
            {
                <li class="channel-item @(SelectedChannelId == channelId ? "selected" : "")"
                    @onclick="() => SelectChannelAsync(channelId)">
                    <span class=\"channel-name\"># @ChannelDisplayHelper.GetDisplayName(channelId)</span>
                </li>
            }
        </ul>
    }
</div>

@if (showCreateModal)
{
    <CreateChannelModal OnCreated="OnChannelCreatedAsync" OnClose="HideCreateModal"/>
}