# Verification

## Claim List

- Builder-first registration will be the default across Mississippi, Reservoir, and Aqueduct.
- Native builder registration will exist only for standalone-capable packages.
- IServiceCollection registration will be retained only as a documented fallback.
- Reservoir registration will be refactored to a store/feature builder model.
- Options configuration will be standardized on builder surfaces.
- Legacy registration entry points will be removed after builder-first replacements exist.
- Public contracts will live in Abstractions projects; implementations in main projects.
- Docs and instruction files will reflect the new builder-first conventions and migration guidance.
- Tests will be updated to use builder-first registration patterns and pass.

## Questions

1. Which packages expose current builder surfaces, and what are their entry point types and namespaces?
2. Where are legacy registration entry points defined, and which ones are still referenced by tests or docs?
3. Which public registration APIs currently accept IServiceCollection directly?
4. Which packages are standalone-capable and already support native builder registration?
5. Are any event-sourcing-related packages exposing native builder registration that should be constrained to Mississippi builders?
6. Is there any shared builder base interface today, or are there multiple ad hoc builder patterns?
7. Where do options get configured today, and how many registrations bypass builder patterns?
8. Which Reservoir registrations exist (store, features, devtools, Blazor) and how are they surfaced?
9. Which Aqueduct registrations exist (server/client/backplane) and how are they surfaced?
10. Are any registration classes currently located in Abstractions projects or leaking implementations into Abstractions?
11. Are there explicit tests covering builder registration, and do they rely on legacy APIs?
12. Which tests will fail if legacy registrations are removed (or signatures change)?
13. Which docs pages mention IServiceCollection-first or legacy registration paths?
14. What migration guidance already exists, if any, for registration changes?
15. Are extension points for storage providers, snapshots, and sagas documented and registered via builders today?
16. What is the minimal set of builder APIs to cover Mississippi, Reservoir, and Aqueduct consistently?
17. Are there internal or public DI registration extension methods that will become unused after builder-first changes?
18. Are there any usage examples in README or docs that must change to builder-first?
19. Are there any breaking public API usages in samples or external-facing docs that require explicit migration notes?
20. Are there CI or script constraints that must be considered for build/test validation of these changes?

## Answers

1. Builder surfaces appear in a few spots: `InletBlazorSignalRBuilder` used by `AddInletBlazorSignalR` in [src/Inlet.Client/InletBlazorRegistrations.cs](src/Inlet.Client/InletBlazorRegistrations.cs) and implemented in [src/Inlet.Client/InletBlazorSignalRBuilder.cs](src/Inlet.Client/InletBlazorSignalRBuilder.cs); Orleans builder extensions in `UseAqueduct` under [src/Aqueduct.Grains/AqueductGrainsRegistrations.cs](src/Aqueduct.Grains/AqueductGrainsRegistrations.cs); Orleans/host builder extensions in `AddEventSourcing` under [src/EventSourcing.Brooks/EventSourcingRegistrations.cs](src/EventSourcing.Brooks/EventSourcingRegistrations.cs). No Mississippi-specific shared builder interface found (see Q6).
2. Legacy IServiceCollection registration entry points are defined in the various `*Registrations` classes across Reservoir, Inlet, Aqueduct, and EventSourcing (e.g., [src/Reservoir/ReservoirRegistrations.cs](src/Reservoir/ReservoirRegistrations.cs), [src/Reservoir.Blazor/ReservoirDevToolsRegistrations.cs](src/Reservoir.Blazor/ReservoirDevToolsRegistrations.cs), [src/Reservoir.Blazor/BuiltIn/ReservoirBlazorBuiltInRegistrations.cs](src/Reservoir.Blazor/BuiltIn/ReservoirBlazorBuiltInRegistrations.cs), [src/Inlet.Client/InletClientRegistrations.cs](src/Inlet.Client/InletClientRegistrations.cs), [src/Inlet.Silo/InletSiloRegistrations.cs](src/Inlet.Silo/InletSiloRegistrations.cs), [src/Inlet.Server/InletServerRegistrations.cs](src/Inlet.Server/InletServerRegistrations.cs), [src/Aqueduct/AqueductRegistrations.cs](src/Aqueduct/AqueductRegistrations.cs), [src/EventSourcing.Brooks/EventSourcingRegistrations.cs](src/EventSourcing.Brooks/EventSourcingRegistrations.cs)). These are referenced directly by tests in the L0 suites (see Q11/Q12) and by docs pages such as devtools/built-in/reservoir/store/effects and event-sourcing-sagas (see Q13).
3. Public registration APIs that accept `IServiceCollection` directly include Reservoir core and features ([src/Reservoir/ReservoirRegistrations.cs](src/Reservoir/ReservoirRegistrations.cs)), Reservoir Blazor DevTools and built-ins ([src/Reservoir.Blazor/ReservoirDevToolsRegistrations.cs](src/Reservoir.Blazor/ReservoirDevToolsRegistrations.cs), [src/Reservoir.Blazor/BuiltIn/ReservoirBlazorBuiltInRegistrations.cs](src/Reservoir.Blazor/BuiltIn/ReservoirBlazorBuiltInRegistrations.cs)), Inlet client/blazor/silo/server/in-process ([src/Inlet.Client/InletClientRegistrations.cs](src/Inlet.Client/InletClientRegistrations.cs), [src/Inlet.Client/InletBlazorRegistrations.cs](src/Inlet.Client/InletBlazorRegistrations.cs), [src/Inlet.Silo/InletSiloRegistrations.cs](src/Inlet.Silo/InletSiloRegistrations.cs), [src/Inlet.Server/InletServerRegistrations.cs](src/Inlet.Server/InletServerRegistrations.cs), [src/Inlet.Server.Abstractions/InletInProcessRegistrations.cs](src/Inlet.Server.Abstractions/InletInProcessRegistrations.cs)), Aqueduct server/backplane registrations ([src/Aqueduct/AqueductRegistrations.cs](src/Aqueduct/AqueductRegistrations.cs)), EventSourcing core services ([src/EventSourcing.Brooks/EventSourcingRegistrations.cs](src/EventSourcing.Brooks/EventSourcingRegistrations.cs)), snapshot/saga registrations ([src/EventSourcing.Snapshots/SnapshotRegistrations.cs](src/EventSourcing.Snapshots/SnapshotRegistrations.cs), [src/EventSourcing.Sagas/SagaRegistrations.cs](src/EventSourcing.Sagas/SagaRegistrations.cs), [src/EventSourcing.Sagas.Abstractions/SagaStepInfoRegistrations.cs](src/EventSourcing.Sagas.Abstractions/SagaStepInfoRegistrations.cs)), and storage provider extensions in Abstractions ([src/EventSourcing.Brooks.Abstractions/Storage/BrookStorageProviderExtensions.cs](src/EventSourcing.Brooks.Abstractions/Storage/BrookStorageProviderExtensions.cs), [src/EventSourcing.Snapshots.Abstractions/SnapshotStorageProviderExtensions.cs](src/EventSourcing.Snapshots.Abstractions/SnapshotStorageProviderExtensions.cs), [src/EventSourcing.Serialization.Abstractions/SerializationStorageProviderExtensions.cs](src/EventSourcing.Serialization.Abstractions/SerializationStorageProviderExtensions.cs)).
4. Standalone-capable builder registration currently exists on Orleans or host builders: `UseAqueduct` for `ISiloBuilder` in [src/Aqueduct.Grains/AqueductGrainsRegistrations.cs](src/Aqueduct.Grains/AqueductGrainsRegistrations.cs) and `AddEventSourcing` for `ISiloBuilder`/`HostApplicationBuilder` in [src/EventSourcing.Brooks/EventSourcingRegistrations.cs](src/EventSourcing.Brooks/EventSourcingRegistrations.cs). The only other builder-style surface is `InletBlazorSignalRBuilder` (client-side configuration) in [src/Inlet.Client/InletBlazorSignalRBuilder.cs](src/Inlet.Client/InletBlazorSignalRBuilder.cs).
5. Event-sourcing builder registration is exposed via `ISiloBuilder` and `HostApplicationBuilder` in [src/EventSourcing.Brooks/EventSourcingRegistrations.cs](src/EventSourcing.Brooks/EventSourcingRegistrations.cs). No Mississippi-specific builder interface is used there today.
6. No shared builder base interface found in source (no `IMississippiBuilder`/`I*Builder` types beyond the specific `InletBlazorSignalRBuilder`). The only explicit builder class is [src/Inlet.Client/InletBlazorSignalRBuilder.cs](src/Inlet.Client/InletBlazorSignalRBuilder.cs); all other registrations are extension methods on `IServiceCollection` or Orleans/host builders.
7. Options are configured via `services.Configure`/`AddOptions` on ServiceCollection methods (e.g., `InletServerOptions` in [src/Inlet.Server/InletServerRegistrations.cs](src/Inlet.Server/InletServerRegistrations.cs), `AqueductOptions` in [src/Aqueduct/AqueductRegistrations.cs](src/Aqueduct/AqueductRegistrations.cs), `ReservoirDevToolsOptions` in [src/Reservoir.Blazor/ReservoirDevToolsRegistrations.cs](src/Reservoir.Blazor/ReservoirDevToolsRegistrations.cs)) and via `siloBuilder.Services.Configure` in [src/Aqueduct.Grains/AqueductGrainsRegistrations.cs](src/Aqueduct.Grains/AqueductGrainsRegistrations.cs). Registrations mostly bypass builder patterns because the dominant surfaces are IServiceCollection extension methods (see Q3).
8. Reservoir registrations include core store/feature/middleware methods in [src/Reservoir/ReservoirRegistrations.cs](src/Reservoir/ReservoirRegistrations.cs), DevTools in [src/Reservoir.Blazor/ReservoirDevToolsRegistrations.cs](src/Reservoir.Blazor/ReservoirDevToolsRegistrations.cs), and built-in Blazor features in [src/Reservoir.Blazor/BuiltIn/ReservoirBlazorBuiltInRegistrations.cs](src/Reservoir.Blazor/BuiltIn/ReservoirBlazorBuiltInRegistrations.cs).
9. Aqueduct registrations exist in the ASP.NET Core backplane layer in [src/Aqueduct/AqueductRegistrations.cs](src/Aqueduct/AqueductRegistrations.cs), with Orleans silo support via `UseAqueduct` in [src/Aqueduct.Grains/AqueductGrainsRegistrations.cs](src/Aqueduct.Grains/AqueductGrainsRegistrations.cs). Inlet server registrations compose Aqueduct via `AddAqueductGrainFactory` and `AddAqueductNotifier` in [src/Inlet.Server/InletServerRegistrations.cs](src/Inlet.Server/InletServerRegistrations.cs).
10. Registration helpers exist in Abstractions projects: `InletInProcessRegistrations` in [src/Inlet.Server.Abstractions/InletInProcessRegistrations.cs](src/Inlet.Server.Abstractions/InletInProcessRegistrations.cs) registers `InProcessProjectionNotifier` (a concrete implementation in an Abstractions project), and saga step registration in [src/EventSourcing.Sagas.Abstractions/SagaStepInfoRegistrations.cs](src/EventSourcing.Sagas.Abstractions/SagaStepInfoRegistrations.cs) creates a concrete `SagaStepInfoProvider<TSaga>` instance. Storage provider registration extensions in Abstractions register caller-supplied implementation types (see Q3).
11. Tests cover registration via ServiceCollection APIs extensively, not builder interfaces. Examples include Reservoir core registrations in [tests/Reservoir.L0Tests/ReservoirRegistrationsTests.cs](tests/Reservoir.L0Tests/ReservoirRegistrationsTests.cs), DevTools in [tests/Reservoir.Blazor.L0Tests/ReservoirDevToolsRegistrationsTests.cs](tests/Reservoir.Blazor.L0Tests/ReservoirDevToolsRegistrationsTests.cs), built-ins in [tests/Reservoir.Blazor.L0Tests/BuiltIn/ReservoirBlazorBuiltInRegistrationsTests.cs](tests/Reservoir.Blazor.L0Tests/BuiltIn/ReservoirBlazorBuiltInRegistrationsTests.cs), Inlet client in [tests/Inlet.Client.L0Tests/InletClientRegistrationsTests.cs](tests/Inlet.Client.L0Tests/InletClientRegistrationsTests.cs), Inlet blazor builder usage in [tests/Inlet.Client.L0Tests/Registrations/InletBlazorRegistrationsTests.cs](tests/Inlet.Client.L0Tests/Registrations/InletBlazorRegistrationsTests.cs), Inlet silo in [tests/Inlet.Silo.L0Tests/InletSiloRegistrationsTests.cs](tests/Inlet.Silo.L0Tests/InletSiloRegistrationsTests.cs), Inlet server in [tests/Inlet.Server.L0Tests/InletServerRegistrationsTests.cs](tests/Inlet.Server.L0Tests/InletServerRegistrationsTests.cs), and Aqueduct in [tests/Aqueduct.L0Tests/AqueductRegistrationsTests.cs](tests/Aqueduct.L0Tests/AqueductRegistrationsTests.cs).
12. If legacy IServiceCollection registrations are removed or signatures change, tests in the files listed in Q11 will fail because they call `Add*` extension methods directly and assert DI registrations (same files as Q11).
13. Docs mention IServiceCollection-first registration flows: DevTools ([docs/Docusaurus/docs/client-state-management/devtools.md](docs/Docusaurus/docs/client-state-management/devtools.md)), built-in navigation/lifecycle ([docs/Docusaurus/docs/client-state-management/built-in-navigation.md](docs/Docusaurus/docs/client-state-management/built-in-navigation.md), [docs/Docusaurus/docs/client-state-management/built-in-lifecycle.md](docs/Docusaurus/docs/client-state-management/built-in-lifecycle.md)), Reservoir overview and store/effects ([docs/Docusaurus/docs/client-state-management/reservoir.md](docs/Docusaurus/docs/client-state-management/reservoir.md), [docs/Docusaurus/docs/client-state-management/store.md](docs/Docusaurus/docs/client-state-management/store.md), [docs/Docusaurus/docs/client-state-management/effects.md](docs/Docusaurus/docs/client-state-management/effects.md)), and event-sourcing sagas referencing `AddInletSilo` ([docs/Docusaurus/docs/event-sourcing-sagas.md](docs/Docusaurus/docs/event-sourcing-sagas.md)).
14. No explicit migration guidance for registration changes found in the docs or README (README contains overview and tooling, but no registration examples beyond conceptual description; [README.md](README.md)).
15. Extension points for storage providers/snapshots/sagas are currently ServiceCollection extensions in Abstractions: brook, snapshot, serialization providers ([src/EventSourcing.Brooks.Abstractions/Storage/BrookStorageProviderExtensions.cs](src/EventSourcing.Brooks.Abstractions/Storage/BrookStorageProviderExtensions.cs), [src/EventSourcing.Snapshots.Abstractions/SnapshotStorageProviderExtensions.cs](src/EventSourcing.Snapshots.Abstractions/SnapshotStorageProviderExtensions.cs), [src/EventSourcing.Serialization.Abstractions/SerializationStorageProviderExtensions.cs](src/EventSourcing.Serialization.Abstractions/SerializationStorageProviderExtensions.cs)) and saga step info registration ([src/EventSourcing.Sagas.Abstractions/SagaStepInfoRegistrations.cs](src/EventSourcing.Sagas.Abstractions/SagaStepInfoRegistrations.cs)). Documentation coverage for these extension points is not evident in the reviewed docs (no dedicated pages found; UNVERIFIED).
16. Minimal builder API set to cover Mississippi/Reservoir/Aqueduct consistently is a design decision; current builder surfaces are limited to `ISiloBuilder`/`HostApplicationBuilder` and the Inlet Blazor SignalR builder (see Q1/Q4). UNVERIFIED until design is finalized.
17. Any builder-first change that removes or de-emphasizes `IServiceCollection` extensions would make the methods listed in Q3 unused or legacy (UNVERIFIED pending design choices).
18. Usage examples in docs clearly rely on `builder.Services.Add*` and `services.Add*` (see Q13). README does not contain registration examples (see [README.md](README.md)).
19. Samples use `builder.Services.Add*` and `siloBuilder.Add*` registrations and would require migration notes: Spring client/server/silo ([samples/Spring/Spring.Client/Program.cs](samples/Spring/Spring.Client/Program.cs), [samples/Spring/Spring.Server/Program.cs](samples/Spring/Spring.Server/Program.cs), [samples/Spring/Spring.Silo/Program.cs](samples/Spring/Spring.Silo/Program.cs)), Crescent L2 tests ([samples/Crescent/Crescent.L2Tests/CrescentFixture.cs](samples/Crescent/Crescent.L2Tests/CrescentFixture.cs)), LightSpeed client ([samples/LightSpeed/LightSpeed.Client/Program.cs](samples/LightSpeed/LightSpeed.Client/Program.cs)).
20. CI/build/test constraints are defined by repository rules: zero warnings, run build/cleanup/tests/mutation via scripts in [\.github/instructions/build-rules.instructions.md](.github/instructions/build-rules.instructions.md) and testing requirements in [\.github/instructions/testing.instructions.md](.github/instructions/testing.instructions.md).
