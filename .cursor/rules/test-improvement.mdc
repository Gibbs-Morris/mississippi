---
description: Test Improvement Workflow (Legacy/Non-TDD Code)
alwaysApply: true
---
# Test Improvement Workflow (Legacy/Non-TDD Code)
**Source:** .github/instructions/test-improvement.instructions.md


# Test Improvement Workflow (Legacy/Non-TDD Code)

Governing thought: Raise coverage/mutation on legacy code through focused test additions without touching production code.

## Rules (RFC 2119)

- Work **MUST NOT** edit outside `tests/` unless explicitly approved. Warnings/errors in tests **MUST** be fixed immediately; suppressions **MUST NOT** be added.
- New tests **MUST** aim for 100% coverage of changed paths (no regressions) and **MUST** keep mutation score ≥80% for Mississippi projects.
- Agents **SHOULD** use `-NoBuild` only after an initial build and **SHOULD** rerun coverage/mutation summarizer scripts to sync tasks.

## Quick Start

1) Restore tools once:
```powershell
pwsh -NoLogo -NoProfile -ExecutionPolicy Bypass -Command "dotnet tool restore"
```
2) Baseline tests + coverage:
```powershell
pwsh ./eng/src/agent-scripts/test-project-quality.ps1 -TestProject <Project>.Tests -SkipMutation
```
3) Build check for warnings:
```powershell
dotnet build ./tests/<Project>/<Project>.csproj -c Release -warnaserror
```
4) Run mutation (Mississippi):
```powershell
pwsh ./eng/src/agent-scripts/test-project-quality.ps1 -TestProject <Project>.Tests
```
Use `-NoBuild` for fast reruns after an initial build.

## Review Checklist

- [ ] Only test files changed unless approved; test warnings resolved with no suppressions.
- [ ] Coverage at target (100% touched, ≥80% overall, aiming 95–100%); mutation ≥80% for Mississippi.
- [ ] Summarizer tasks refreshed when gaps remain; `-NoBuild` used only after an initial build.
