---
description: Orleans Serialization
globs: ["**/*.cs"]
alwaysApply: false
---
# Orleans Serialization
**Source:** .github/instructions/orleans-serialization.instructions.md


# Orleans Serialization

Governing thought: Use explicit `[GenerateSerializer]`, `[Id]`, and `[Alias]` with progressive versioning to keep Orleans payloads compatible across deployments.

> Drift check: Review Orleans analyzer settings and package references (`Microsoft.Orleans.Sdk`, `Microsoft.Orleans.CodeGenerator.MSBuild`) before changes.

## Rules (RFC 2119)

- Serializable types **MUST** use `[GenerateSerializer]` plus `[Id(n)]` on every serialized member; implicit serialization **MUST NOT** be used. Why: Enables version-tolerant code generation.
- Types **MUST** include globally unique `[Alias]`; member IDs **MUST** start at 0 per inheritance level and be unique/unchanged for that level. Why: Supports safe renames and deterministic layout.
- Existing member IDs **MUST NOT** change; breaking type changes (e.g., record-to-class or signedness changes) **MUST NOT** be made. New members **MUST** use unused IDs. Why: Protects rolling deployments.
- Versioning **MUST** follow additive/compatible changes; removals **SHOULD** use `[NonSerialized]`/`[Obsolete]`; widening numeric types and making properties nullable **SHOULD** be preferred over narrowing. Why: Keeps serialized data readable.
- Projects **MUST** include required Orleans packages and build with analyzers as errors; reviewers **SHOULD** verify compatibility. Why: Catches issues at build/review time.
- Analyzer violations or missing attributes **SHOULD** have focused `.scratchpad/tasks/pending` items if not fixed immediately. Why: Tracks debt.

## Scope and Audience

Developers creating or changing Orleans-serialized types.

## At-a-Glance Quick-Start

- Add `[GenerateSerializer]`, `[Alias("Namespace.TypeName")]` (fully qualified type name), `[Id(n)]` (starting at 0) to members.
- Keep IDs stable; add new members with new IDs; prefer widening/nullability changes.
- Include Orleans SDK/codegen packages; treat analyzer warnings as errors.

## Core Principles

- Explicit, stable identifiers prevent serialization breaks.
- Additive versioning supports rolling upgrades.

## References

- Orleans serialization docs: <https://learn.microsoft.com/dotnet/orleans/serialization>
- Shared guardrails: `.github/instructions/shared-policies.instructions.md`
- Domain modeling: `.github/instructions/domain-modeling.instructions.md`
