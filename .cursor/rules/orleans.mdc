---
description: Orleans Best Practices for Mississippi Framework
globs: ["**/*.cs"]
alwaysApply: false
---
# Orleans Best Practices for Mississippi Framework
**Source:** .github/instructions/orleans.instructions.md


# Orleans Best Practices for Mississippi Framework

Governing thought: Implement Orleans grains as POCOs with explicit DI and extension methods.

## Rules (RFC 2119)

- Grains **MUST** implement `IGrainBase` and **MUST NOT** inherit from `Grain`; inject `IGrainContext` and other services via constructors with get-only properties. Include `using Orleans.Runtime` and call Orleans helpers with `this.` qualification.
- Dependency injection **MUST** use the property pattern (no private readonly DI fields). All dependencies, including persistent state, **MUST** be constructor-injected; use `IPersistentState<T>` instead of `Grain<TState>`.
- Grains currently inheriting from `Grain` **SHOULD** be migrated to POCO; deferred migrations **SHOULD** be recorded as `.scratchpad/tasks` items.

## Quick Start

- Scaffold grains as POCO classes implementing grain interfaces + `IGrainBase`; add `IGrainContext` and DI services via constructor.
- Replace direct base-class calls with extension methods (`this.GetPrimaryKey*`, `this.RegisterGrainTimer`, `this.RegisterOrUpdateReminder`, etc.).
- Use property-pattern DI and keep grains sealed unless composition requires otherwise.

## Review Checklist

- [ ] Grain implements `IGrainBase` (no `Grain` inheritance) and injects `IGrainContext` + dependencies.
- [ ] Orleans extension methods used with `this.`; persistent state injected via `IPersistentState<T>`.
- [ ] DI uses get-only properties; any remaining base-class grains tracked for migration.
